{% extends 'layouts/admin_base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block styles %}
<link rel="stylesheet" href="{% static 'account/styles/register.css' %}">
{% endblock %}

{% block title %}Создание пользователя{% endblock title %}

{% block content %}

<!-- {{ form }} -->
{% if user.is_superuser %}  
<main class="register-page">
    <div class="login-project-block">
        <div class="row">
            <h2 class="register-main-title">Добавление нового пользователя</h2>
        </div>

        <section class="main-section">
            <div class="form-block">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ form.non_field_errors }}
                    <div class="field-rows">
                        {{ form.name }}
                        {{ form.surname }}
                        {{ form.patronymic }}
                    </div>

                    <div class="field-rows">
                        {{ form.email }}
                        {{ form.avatar }}
                        <button class="btn btn-success avatar-button register-field" id="avatar-button">Фото пользователя</button>
                        {{ form.role }}
                    </div>

                    <div class="field-rows">
                        {{ form.password1 }}
                        {{ form.password2 }}
                    </div>
                    
                    <button class="btn btn-success" type="submit">Создать пользователя</button>
                </form>
    
            </div>

            <div class="info-block">
                <div class="avatar-preview-block"></div>
                <button class="btn btn-danger">Удалить фото</button>

            </div>

        </section>

       
        
        
    </div>

</main>
{% else %}
<h2>Вы не администратор. Авторизуйтесь как администратор.</h2>
{% if user.is_active %}
{{ user }}    
<a href="{% url 'user_all_projects' %}">Все проекты</a>
<form method="post" action="{% url 'logout' %}" style="display: inline;">
    {% csrf_token %}
    <button type="submit">Выйти</button>
</form> 
{% else %}
<h2>Анонимный пользователь</h2>
<a href="{% url 'login' %}">Страница авторизации</a>
{% endif %}
{% endif %}


{% if form.errors %}
    <ul>
        {% for field in form %}
            {% for error in field.errors %}
                <li>{{ field.label }}: {{ error }}</li>
            {% endfor %}
        {% endfor %}
        {% for error in form.non_field_errors %}
            <li>{{ error }}</li>
        {% endfor %}
    </ul>
{% endif %}

{% endblock content %}

{% block footerScripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{% static 'account/scripts/script.js' %}"></script>

{% endblock footerScripts %}






